{% extends 'student/base_new.html' %}

{% block title %}Results - Student Management System{% endblock %}

{% block content %}
<h1 class="page-title">
    <i class="fas fa-chart-bar"></i>
    Results
</h1>

<!-- Search Box -->
<div class="card" style="margin-bottom: 20px;">
    <form method="GET" style="display: flex; gap: 10px;">
        <input type="text" name="search" placeholder="Search by student name or subject..." value="{{ search_query }}" style="flex: 1; padding: 11px 13px; border: 1px solid #d1d9e0; border-radius: 5px; font-size: 1rem;">
        <button type="submit" class="btn btn-primary"><i class="fas fa-search"></i> Search</button>
        {% if search_query %}
            <a href="{% url 'results_list' %}" class="btn btn-secondary"><i class="fas fa-times"></i> Clear</a>
        {% endif %}
    </form>
</div>

<!-- Add Result Button -->
<div style="margin-bottom: 20px;">
    <a href="{% url 'add_result' %}" class="btn btn-success"><i class="fas fa-plus"></i> Add New Result</a>
</div>

{% if results %}
    <p style="color: #7f8c8d; margin-bottom: 15px; font-size: 0.9rem;"><i class="fas fa-info-circle"></i> Found {{ results.count }} result(s)</p>

    <!-- Results Table -->
    <div class="table-responsive">
        <table>
            <thead>
                <tr>
                    <th>#</th>
                    <th>Student</th>
                    <th>Subject</th>
                    <th>Marks</th>
                    <th>Grade</th>
                    <th style="text-align: center;">Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for result in results %}
                <tr>
                    <td>{{ forloop.counter }}</td>
                    <td><strong><a href="{% url 'student_detail' result.student.id %}" style="color: #34495e; text-decoration: none; font-weight: 600;">{{ result.student.name }}</a></strong></td>
                    <td>{{ result.subject }}</td>
                    <td>{{ result.marks }}/100</td>
                    <td>
                        <span style="padding: 6px 10px; border-radius: 4px; font-weight: 600;
                            {% if result.grade == 'A' %}background: #f0fdf4; color: #166534;
                            {% elif result.grade == 'B' %}background: #eff6ff; color: #1e40af;
                            {% elif result.grade == 'C' %}background: #fefce8; color: #854d0e;
                            {% elif result.grade == 'F' %}background: #fef2f2; color: #991b1b;
                            {% endif %}
                        ">
                            {{ result.grade }}
                        </span>
                    </td>
                    <td style="text-align: center;">
                        <a href="{% url 'edit_result' result.id %}" class="btn btn-secondary btn-sm"><i class="fas fa-edit"></i></a>
                        <a href="{% url 'delete_result' result.id %}" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure?')"><i class="fas fa-trash"></i></a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% else %}
    <div class="card" style="text-align: center; padding: 60px;">
        <i class="fas fa-inbox" style="font-size: 3rem; color: #d1d9e0; margin-bottom: 20px;"></i>
        <h3 style="color: #34495e;">No Results Found</h3>
        <p style="color: #95a5a6; margin-bottom: 20px; margin-top: 10px;">
            {% if search_query %}
                No results match your search criteria.
            {% else %}
                No results added yet. Start by adding a result!
            {% endif %}
        </p>
        <a href="{% url 'add_result' %}" class="btn btn-primary"><i class="fas fa-plus"></i> Add First Result</a>
    </div>
{% endif %}

{% endblock %}
